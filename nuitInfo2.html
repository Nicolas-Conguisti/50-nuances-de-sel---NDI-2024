<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id='div_ciel'>
        <img src="image/fond_mer/epave.png" id="image_epavefinale" width="300px" height="200px" alt="" style="position: absolute; left: 350px; top: 200px;">
    </div>
    <div id='div_surface_mer' style="position: relative;">
        <img src="image/globals/merci.jpg" id="merci4" width="100px" height="100px" alt="">
        <img src="image/surface/Prochlorococcus .jpg" width="100px" height="100px" alt="">
        <h2>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Omnis, vel illo quod repudiandae deserunt in aliquam sed tenetur eligendi illum nobis, itaque dolor commodi consequatur beatae dicta, hic nemo reprehenderit.</h2>
        <img src="image/surface/bouteil.jpg" id="image_bouteil1" class="draggable" width="100px" height="100px" alt="">
        <img src="image/surface/bouteil.jpg" id="image_bouteil2" class="draggable" width="100px" height="100px" alt="">
        <img src="image/surface/bouteil.jpg" id="image_bouteil3" class="draggable" width="100px" height="100px" alt="">
        <img src="image/surface/bouteil.jpg" id="image_bouteil4" class="draggable" width="100px" height="100px" alt="">
        <img src="image/surface/bouteil.jpg" id="image_bouteil5" class="draggable" width="100px" height="100px" alt="">
        

    </div>
    <div id='div_profondeur_1' style="position: relative;">
        <img src="image/globals/merci.jpg" id="merci3" width="100px" height="100px" alt="">
        <img src="image/profondeur_1/Prochlorococcus .jpg" width="100px" height="100px" alt="">
        <h2>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Omnis, vel illo quod repudiandae deserunt in aliquam sed tenetur eligendi illum nobis, itaque dolor commodi consequatur beatae dicta, hic nemo reprehenderit.</h2>
        <img src="image/profondeur_1/algue.jpg" id="image_algue1" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_1/algue.jpg" id="image_algue2" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_1/algue.jpg" id="image_algue3" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_1/algue.jpg" id="image_algue4" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_1/algue.jpg" id="image_algue5" class="draggable" width="100px" height="100px" alt="">
        
    </div>
    <div id="div_profondeur_2" style="position: relative;">
        <img src="image/globals/merci.jpg" id="merci2" width="100px" height="100px" alt="">
        <img src="image/profondeur_2/diatomées.jpg" width="100px" height="100px" alt="">
        <h2>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Omnis, vel illo quod repudiandae deserunt in aliquam sed tenetur eligendi illum nobis, itaque dolor commodi consequatur beatae dicta, hic nemo reprehenderit.</h2>
        <img src="image/profondeur_2/bulle_red.jpg" id="image_bulle_red1" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_2/bulle_red.jpg" id="image_bulle_red2" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_2/bulle_red.jpg" id="image_bulle_red3" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_2/bulle_red.jpg" id="image_bulle_red4" class="draggable" width="100px" height="100px" alt="">
        <img src="image/profondeur_2/bulle_red.jpg" id="image_bulle_red5" class="draggable" width="100px" height="100px" alt="">
    </div>
    <div id='div_fond_mer' class="random-parent" >
        <h2>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Omnis, vel illo quod repudiandae deserunt in aliquam sed tenetur eligendi illum nobis, itaque dolor commodi consequatur beatae dicta, hic nemo reprehenderit.</h2>

         <img src="image/globals/merci.jpg" id="merci1" width="100px" height="100px" alt="">
         <img src="image/fond_mer/Benthos.webp" width="100px" height="100px" alt="">
         <img src="image/fond_mer/Benthos.webp" width="100px" height="100px" alt="">
         <img src="image/fond_mer/Benthos.webp" width="100px" height="100px" alt="">
         <img src="image/fond_mer/Benthos.webp" width="100px" height="100px" alt="">
         <img src="image/globals/anhilateur.jpg" id="image_anhilateur" width="300px" height="200px" alt="" style="position: absolute; left: 0; top: 50px;">
        <img src="image/globals/machine.jpg" id="image_machine" width="300px" height="200px" alt="" style="position: absolute; left: 50px; top: 150px;">
        <img src="image/globals/plongeur.jpg" id="image_plongeur" width="300px" height="200px" alt="" style="position: absolute; left: 150px; top: 250px;">
        <img src="image/globals/tuyau.jpg" id="image_tuyau" width="300px" height="200px" alt="" style="position: absolute; left: 300px; top: 50px;">
        <img src="image/fond_mer/epave.png" id="image_epave" width="300px" height="200px" alt="" style="position: absolute; left: 350px; top: 200px;">
        <img src="image/fond_mer/metal.jpg" id="image_metal1" class="draggable random-child" width="200px" height="100px" alt="">
        <img src="image/fond_mer/metal.jpg" id="image_metal2" class="draggable random-child" width="200px" height="100px" alt="">
        <img src="image/fond_mer/metal.jpg" id="image_metal3" class="draggable random-child" width="200px" height="100px" alt="">
        <img src="image/fond_mer/metal.jpg" id="image_metal4" class="draggable random-child" width="200px" height="100px" alt="">
        <img src="image/fond_mer/metal.jpg" id="image_metal5" class="draggable random-child" width="200px" height="100px" alt="">
    </div>

</body>
</html>

<script>
    //let  maxScrollY = 4000; // Limite en pixels
    const  maxScrollY = 10; // Limite en pixels

    window.addEventListener('scroll', () => {
    if (window.scrollY < maxScrollY) {
        window.scrollTo(0, maxScrollY); // Force la position du scroll
    }
    });

    let nbdestroy = 0;

    // Liste des images à animer
    const imagesToAnimate = [
    "image_anhilateur",
    "image_machine",
    "image_plongeur",
    "image_tuyau",
    "image_epave",
    ];


    // Récupérer les divs source et destination
    const div_fond_mer = document.getElementById("div_fond_mer");
    const div_profondeur_2 = document.getElementById("div_profondeur_2");
    const div_profondeur_1 = document.getElementById("div_profondeur_1");
    const div_surface_mer = document.getElementById("div_surface_mer");
    const merci1 = document.getElementById("merci1");
    merci1.style.display = 'none';
    const merci2 = document.getElementById("merci2");
    merci2.style.display = 'none';
    const merci3 = document.getElementById("merci3");
    merci3.style.display = 'none';
    const merci4 = document.getElementById("merci4");
    merci4.style.display = 'none';
    
    // move_global_to(div_profondeur_2,div_profondeur_1)
    function move_global_to(divSource,divDestination)
    {        
        // Fonction pour animer une image
        function animateImage(imageId, destinationX, destinationY) {
        const image = document.getElementById(imageId);
        const startRect = image.getBoundingClientRect();
        const containerRect = divSource.getBoundingClientRect();

        // Position actuelle relative au conteneur source
        const startX = startRect.left - containerRect.left;
        const startY = startRect.top - containerRect.top;

        // Calcul des distances à parcourir
        const deltaX = destinationX - startX;
        const deltaY = destinationY - startY;

        // Durée de l'animation en millisecondes
        const duration = 2000; // 2 secondes
        let startTime;

        // Fonction de mise à jour de l'animation
        function step(timestamp) {
            if (!startTime) startTime = timestamp;
            const elapsed = timestamp - startTime;

            // Calcul de la progression (entre 0 et 1)
            const progress = Math.min(elapsed / duration, 1);

            // Mettre à jour la position de l'image
            image.style.left = startX + deltaX * progress + "px";
            image.style.top = startY + deltaY * progress + "px";

            // Continuer l'animation ou la terminer
            if (progress < 1) {
            requestAnimationFrame(step);
            } else {
            // Déplacer l'image dans le div destination
            divDestination.appendChild(image);
            image.style.position = "absolute";
            image.style.left = destinationX + "px";
            image.style.top = destinationY + "px";
            }
        }

        requestAnimationFrame(step);
        }

        // Lancer l'animation pour chaque image
        imagesToAnimate.forEach((imageId, index) => {
        // Calculer des positions de destination aléatoires dans le div destination
        const destinationX = Math.random() * (divDestination.clientWidth - 300); // 300 = largeur image
        const destinationY = Math.random() * (divDestination.clientHeight - 200); // 200 = hauteur image

        // Lancer l'animation avec un délai entre chaque image
        setTimeout(() => {
            animateImage(imageId, destinationX, destinationY);
        }, index * 500); // Décalage de 500ms entre les animations
        });
    }




    function definir_drag_drop(badThing,hole,container)
    {
        let isDragging = false;
        let offsetX, offsetY;

        // Activer le déplacement quand on clique sur l'image de "metal"
        badThing.addEventListener("mousedown", (e) => {
        isDragging = true;

        // Calculer l'offset entre la position de la souris et le coin de l'image
        const rect = badThing.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;

        // Empêcher un comportement par défaut (sélection de texte, etc.)
        e.preventDefault();
        });

        // Déplacement de l'image quand la souris bouge
        document.addEventListener("mousemove", (e) => {
        if (isDragging) 
        {
            const containerRect = container.getBoundingClientRect();

            // Calculer les nouvelles positions
            let newLeft = e.clientX - containerRect.left - offsetX;
            let newTop = e.clientY - containerRect.top - offsetY;

            // Limiter les positions aux bords du conteneur
            newLeft = Math.max(0, Math.min(newLeft, containerRect.width - badThing.offsetWidth));
            newTop = Math.max(0, Math.min(newTop, containerRect.height - badThing.offsetHeight));

            // Appliquer les nouvelles positions
            badThing.style.left = newLeft + "px";
            badThing.style.top = newTop + "px";

            // Vérifier si l'image touche l'image de l'anhilateur
            const metalRect = badThing.getBoundingClientRect();
            const anhilateurRect = hole.getBoundingClientRect();

            const isOverlapping = !(metalRect.right < anhilateurRect.left ||
                                    metalRect.left > anhilateurRect.right ||
                                    metalRect.bottom < anhilateurRect.top ||
                                    metalRect.top > anhilateurRect.bottom);

            if (isOverlapping) {
                // Si chevauchement, cacher l'image de l'anhilateur
                badThing.style.display = 'none';
                nbdestroy ++;
                switch (nbdestroy) {
                    case 5:           
                        move_global_to(div_fond_mer,div_profondeur_2)
                        merci1.style.display = 'block';            
                        console.log(5)                     ;
                        maxScrollY -= 1000; 
                        break;
                    case 10:                        
                        move_global_to(div_profondeur_2,div_profondeur_1)             
                        merci1.style.display = 'block';
                        maxScrollY -= 1000; 
                        console.log(10)                     ;
                        break;
                    case 15:                        
                        move_global_to(div_profondeur_1,div_surface_mer)             
                        merci1.style.display = 'block';
                        maxScrollY -= 1000; 
                        console.log(15)                     ;
                        break;
                    case 20:   
                        maxScrollY -= 1000; 
                        merci1.style.display = 'block';
                        console.log(20)                     ;
                        break;
                
                    default:
                        break;
                }
            }
        }
        });

        // Désactiver le déplacement quand on relâche la souris
        document.addEventListener("mouseup", () => {
            isDragging = false;
        });
        
    }
    
    const anhilateurImage = document.getElementById("image_anhilateur");
    const container1 = document.getElementById("div_fond_mer");
    
    const metalImage1 = document.getElementById("image_metal1");
    definir_drag_drop(metalImage1,anhilateurImage,container1)
    const metalImage2 = document.getElementById("image_metal2");
    definir_drag_drop(metalImage2,anhilateurImage,container1)
    const metalImage3 = document.getElementById("image_metal3");
    definir_drag_drop(metalImage3,anhilateurImage,container1)
    const metalImage4 = document.getElementById("image_metal4");
    definir_drag_drop(metalImage4,anhilateurImage,container1)
    const metalImage5 = document.getElementById("image_metal5");
    definir_drag_drop(metalImage5,anhilateurImage,container1)

    
    const container2 = document.getElementById("div_profondeur_2");
    const image_bulle_red1 = document.getElementById("image_bulle_red1");
    definir_drag_drop(image_bulle_red1,anhilateurImage,container2)
    const image_bulle_red2 = document.getElementById("image_bulle_red2");
    definir_drag_drop(image_bulle_red2,anhilateurImage,container2)
    const image_bulle_red3 = document.getElementById("image_bulle_red3");
    definir_drag_drop(image_bulle_red3,anhilateurImage,container2)
    const image_bulle_red4 = document.getElementById("image_bulle_red4");
    definir_drag_drop(image_bulle_red4,anhilateurImage,container2)
    const image_bulle_red5 = document.getElementById("image_bulle_red5");
    definir_drag_drop(image_bulle_red5,anhilateurImage,container2)
    

    const container3 = document.getElementById("div_profondeur_1");
    const image_algue1 = document.getElementById("image_algue1");
    definir_drag_drop(image_algue1,anhilateurImage,container3)
    const image_algue2 = document.getElementById("image_algue2");
    definir_drag_drop(image_algue2,anhilateurImage,container3)
    const image_algue3 = document.getElementById("image_algue3");
    definir_drag_drop(image_algue3,anhilateurImage,container3)
    const image_algue4 = document.getElementById("image_algue4");
    definir_drag_drop(image_algue4,anhilateurImage,container3)
    const image_algue5 = document.getElementById("image_algue5");
    definir_drag_drop(image_algue5,anhilateurImage,container3)
    

    const container4 = document.getElementById("div_surface_mer");
    const image_bouteil1 = document.getElementById("image_bouteil1");
    definir_drag_drop(image_bouteil1,anhilateurImage,container4)
    const image_bouteil2 = document.getElementById("image_bouteil2");
    definir_drag_drop(image_bouteil2,anhilateurImage,container4)
    const image_bouteil3 = document.getElementById("image_bouteil3");
    definir_drag_drop(image_bouteil3,anhilateurImage,container4)
    const image_bouteil4 = document.getElementById("image_bouteil4");
    definir_drag_drop(image_bouteil4,anhilateurImage,container4)
    const image_bouteil5 = document.getElementById("image_bouteil5");
    definir_drag_drop(image_bouteil5,anhilateurImage,container4)
    


    

</script>